<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<link rel="stylesheet" href="styles.css" />
		<title>Any Gamers in the Chat? ðŸ¤”</title>
	</head>
	<body id="body">
		<div id="canvas">
			<img
				src="https://www.piskelapp.com/static/resources/home/features/feature-open-source@2x.gif"
				alt="Sprite"
				id="sprite"
			/>
		</div>
		<script>
			const randomInt = (min, max) => {
				return Math.random() * (max - min) + min;
			};
			const speed = 5;
			const treeCount = 20;
			const fireballCount = 1;
			const width = document.getElementById('canvas').clientWidth;
			const height = document.getElementById('canvas').clientHeight;
			const bodyWidth = document.getElementById('body').clientWidth;
			const bodyHeight = document.getElementById('body').clientHeight;

			const sprite = document.getElementById('sprite');
			const treeArray = [];
			var keyState = {};
			const canvas = document.getElementById('canvas').getBoundingClientRect();
			for (var i = 0; i < fireballCount; i++) {
				const fireball = document.createElement('img');
				fireball.className = 'fireball';
				fireball.src =
					'https://thumbs.gfycat.com/SlipperyObedientBasil-max-1mb.gif';
				fireball.style.left = randomInt(canvas.left, canvas.right - 100) + 'px';
				fireball.style.top = randomInt(canvas.top, canvas.bottom - 100) + 'px';
				document.getElementById('body').appendChild(fireball);
			}
			const fireballs = document.getElementsByClassName('fireball');
			const fireballArray = new Array(fireballCount)
				.fill(null)
				.map((fireball, index) => {
					const fireballRect = fireballs[index].getBoundingClientRect();
					return {
						left: fireballRect.left,
						right: fireballRect.right,
						top: fireballRect.top,
						bottom: fireballRect.bottom,
					};
				});
			console.log(fireballArray);
			// document.getElementById('canvas').style.width = width + 'px';
			// document.getElementById('canvas').style.height = height + 'px';
			window.addEventListener(
				'keydown',
				function (e) {
					keyState[e.keyCode || e.which] = true;
				},
				true
			);

			window.addEventListener(
				'keyup',
				function (e) {
					keyState[e.keyCode || e.which] = false;
				},
				true
			);
			// creating trees
			for (var i = 0; i < treeCount; i++) {
				const tree = document.createElement('img');
				tree.className = 'tree';
				tree.src = 'assets/props_tree_goup.png';
				tree.style.left = randomInt(canvas.left, canvas.right - 100) + 'px';
				tree.style.top = randomInt(canvas.top, canvas.bottom - 100) + 'px';
				treeArray.push(tree);
				document.getElementById('body').appendChild(tree);
			}
			var x = width / 2;
			var y = height / 2;
			var hit = false;
			(function gameLoop() {
				//check to see if we were hit by a fireball
				// sprite x -> x+100 && y -> y-100
				// fireball left -> right && top -> bottom
				console.log(hit);
				fireballArray.forEach((fireball) => {
					if (
						(x <= fireball.left <= x + 100 || x <= fireball.right <= x + 100) &&
						(y <= fireball.top <= y + 100 || y <= fireball.bottom <= y + 100)

						// (x >= fireball.left &&
						// 	x <= fireball.right &&
						// 	y <= fireball.bottom &&
						// 	y >= fireball.top) ||
						// (x + 100 >= fireball.left &&
						// 	x + 100 <= fireball.right &&
						// 	y + 100 <= fireball.bottom &&
						// 	y + 100 >= fireball.top)
					) {
						hit = true;
					}
				});

				if ((keyState[37] || keyState[65]) && x > canvas.left) {
					// left
					x -= speed;
				}
				if (
					(keyState[39] || keyState[68]) &&
					x < canvas.right - sprite.clientWidth
				) {
					// right
					x += speed;
				}
				if ((keyState[38] || keyState[87]) && y > canvas.top) {
					// up
					y -= speed;
				}
				if (
					(keyState[40] || keyState[83]) &&
					y < canvas.bottom - sprite.clientHeight
				) {
					// down
					y += speed;
				}

				document.getElementById('sprite').style.left = x + 'px';
				document.getElementById('sprite').style.top = y + 'px';
				setTimeout(gameLoop, 10);
			})();
		</script>
	</body>
</html>
